# iwara等自动化视频爬取

这是一个基于 **Telethon** 框架开发的自动化媒体爬取与分发系统 。该系统旨在自动从特定媒体站点抓取资源，通过 **Aria2** 进行下载，并在处理后将其推送至指定的 Telegram 频道。

## 🛠️ 核心功能


* **多阶段爬虫逻辑**：
* 支持绕过 Cloudflare 防护。
* 自动提取视频元数据、下载地址及排行榜信息。


* **高效下载管理**：对接 **Aria2 RPC** 接口，支持批量异步下载任务。
* **自动化媒体处理**：
* 自动生成视频封面图与缩略图。
* 根据预设规则清理文件名。


* 
**数据持久化**：使用 `aiosqlite` 记录已处理资源，防止重复抓取与推送 。


* **远程指令控制**：管理员可通过 Telegram 指令实时管理任务状态（启动、暂停、恢复、关机）。

## 🏗️ 技术架构

* 
**核心框架**：`Telethon` (MTProto) 


* **任务调度**：`APScheduler`
* **解析引擎**：`lxml` + `Playwright` 

* 
**数据库**：`aiosqlite` 



## 🚀 部署步骤

### 1. 准备环境

确保系统已安装 Python 3.9+ 以及 Aria2 服务。

```bash
pip install -r requirements.txt

```

### 2. 配置说明

项目依赖多个 JSON/YAML 配置文件，请根据示例文件进行创建：

* **`token.json`**: 配置 Telegram API 凭据 (`api_id`, `api_hash`, `bot_token`)。
* **`bot_cfg.json`**: 配置管理员用户 ID 及机器人用户名。
* **`aria2.json`**: 配置 Aria2 RPC 地址及 Token。
* **`hanime1.yaml`**: 配置爬虫参数、代理及目标频道 ID。

### 3. 运行

```bash
python main.py

```

## ⌨️ 管理指令

| 指令 | 作用 | 权限 |
| --- | --- | --- |
| `/update` | 启动所有定时任务调度器 | 管理员 |
| `/h_resume` / `/h_stop` | 恢复/暂停指定站点的定时更新 | 管理员 |
| `/run_hanime1` | 立即触发一次全流程任务 | 管理员 |
| `/bye` | 安全关闭机器人并断开连接 | 管理员 |

## ⚠️ 免责声明

1. 本程序仅供技术交流与学术研究使用。
2. 用户在使用本程序时，必须遵守当地法律法规以及目标网站的 Robots 协议。
3. 因非法使用本程序而产生的任何法律后果，由使用者自行承担，开发者不承担任何连带责任。

---
